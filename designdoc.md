# ML System Design Doc - [RU]
## Дизайн ML системы по распознаванию жестов (MVP v0.0.1)

### 1. Цели и предпосылки 
#### 1.1. Зачем идем в разработку продукта?  

Задача распознавани жестов имеет множество применений от распознавания языка жестов, помогающего людям с ограниченными способностями взаимодействовать с другими людьми, до упрощения взаимодействия между человеком и компьютером.
Больше об областях применения можно почитать по [ссылке](https://datagen.tech/guides/pose-estimation/gesture-recognition/#:~:text=Gesture%20recognition%20is%20the%20ability,and%20even%20finger%2Dwritten%20symbols.).

Несмотря на это, задача считается сложной и не имеющей эталонного решения.

Мы сфокусируемся на одной области применения - распознавании языка жестов, поскольку он включает ограниченный набор жестов, кроме того, существуют наработки других команд, с которыми можно сравнивать качество своего решения.

Успехом будет считаться создание системы автоматического перевода последостельности жестов, плавно переходящих из одного в другой, в связный текст (опечатки не важны, важны ключевые слова и общий смысл).
**Идеальный вариант** - если решение сможет обрабатывать потоковое видео в режиме реального времени. Более простой **приемлемый вариант**, который также будет считаться успехом - обработка загруженного видео и выдача текста с той скоростью, с которой позволяется сервис (оффлайн).
 

#### 1.2. Бизнес-требования и ограничения  

Система должна принимать на вход видео, содержащее последовательность жестов, показываемых человеком
Это именно единое видео, а не склеенная нарезка из последовательности жестов.
Система должна суметь локализовать жесты (кадрировать изображения), распознать их, сравнивая с жестами из ограниченного словаря, и объединить распознанные токены в связный текст.
Результатом работы системы является связный текст (одно предложение, без учета пунктуации и регистра).

Бизнес-процесс пилота:
1. Получение видео произвольной длины (из интернета или запись) и текста предложения
2. Распознавание текста с помощью модели
3. Оценка качества через сопоставление распознанного текста с GT из п.1

Пилот считается успешным, если система способна работать с видео разной длины, где жесты демонстрируют разные люди, при этом качество модели составляет ... (TODO).

#### 1.3. Что входит в скоуп проекта/итерации, что не входит   

Проект фокусируется на распознавании текста только на русском языке.

#### 1.4. Предпосылки решения  

TODO

### 2. Методология `Data Scientist`     

#### 2.1. Постановка задачи  

Video2Text: перевод видео в текст. Очень похоже на Voice2Text, но вместо звуковой дорожки на входе данных большей размерности - видео.

#### 2.2. Блок-схема решения  

Baseline (TODO)

Main MVP (TODO)

#### 2.3. Этапы решения задачи `Data Scientist`  

1. Изучение готовых решений (paperswithcode, github, kaggle)
2. Выбор из них baseline
3. Определение подхода к решению задачи
4. Получение данных (скорее всего готовый датасет)
5. EDA
6. Определение сквозной метрики качества и приемлемого значения этой метрики
7. Обучение модели распознавания символа по жесту
8. Создание алгоритма склейки предсказаний с нескольких последовательных кадров в одно
9. Создание механизма предобработки видео (input MVP) для приближения данных к формату, используемому при обучении модели
10. Сквозная оценка качества на тестовой выборке
11. Создание интерфейса взаимодействия с моделью
12. Разворачивание сервиса

Пока подход (п.3) видится следующим:
* Обучение модели классификации изображений (кадров видео) производится на основе готового датасета, включающего изображения рук крупным планом, жестко фиксируется набор классов
* Обучение модели детекции для кадрирования более крупного изображения
* Создание механизма склейки предсказаний модели классификации
* При инференсе:
    * на вход подается видео (является триггером запуска модели)
    * видео режется на кадры с определенной частотой (TODO: подобрать по скорости инференса моделей)
    * каждое полученное изображение кадрируется
    * и классифицируется
    * полученная последовательность классов склеивается в единое предсказание - текст
    * записывается лог запуска: версия модели, предсказание
* Дополнительная функциональность на время проведения пилота:
    * полученный текст демонстрируется пользователю
    * пользователь должен скорректировать текст, чтобы система могла запомнить правильный ответ
    * рассчитывается сквозная метрика качества для данного примера
    * в базу данных записывается: видео (или путь к нему), текст GT, текст предсказанный, версия модели, рассчитанное значение метрики качества
* Опциональные шаги:
    * Изменение подхода к решению задачи на основе результатов пилота
    * Дообучение моделей на основе данных, записанных в БД в процессе пилота

Критерии для перестроения (TODO)

TODO
  
### 3. Подготовка пилота  
  
#### 3.1. Способ оценки пилота  
  
TODO
  
#### 3.2. Что считаем успешным пилотом  
  
TODO
  
#### 3.3. Подготовка пилота  
  
TODO

### 4. Внедрение `для production систем, если требуется`    

> Заполнение раздела 4 требуется не для всех дизайн документов. В некоторых случаях результатом итерации может быть расчет каких-то значений, далее используемых в бизнес-процессе для пилота.  
  
#### 4.1. Архитектура решения   
  
TODO
  
#### 4.2. Описание инфраструктуры и масштабируемости 
  
TODO
  
#### 4.3. Требования к работе системы  
  
TODO
  
#### 4.4. Безопасность системы  
  
TODO
  
#### 4.5. Безопасность данных   
  
TODO
  
#### 4.6. Издержки  

TODO
  
#### 4.5. Integration points  
  
TODO
  
#### 4.6. Риски  
  
TODO